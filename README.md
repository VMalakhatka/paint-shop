# üõí Paint Shop (WooCommerce)

E-commerce –ø—Ä–æ–µ–∫—Ç –Ω–∞ –±–∞–∑–µ **WordPress + WooCommerce**, –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥ –∑–∞–¥–∞—á–∏ –º–∞–≥–∞–∑–∏–Ω–∞ –∫—Ä–∞—Å–æ–∫.

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
<details>
<summary><strong>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞</strong></summary>

```text
wp-content/
‚îú‚îÄ mu-plugins/
‚îÇ  ‚îú‚îÄ psu-force-per-page.php        # per_page = –∫–æ–ª–æ–Ω–∫–∏ √ó —Ä—è–¥—ã (cookie psu_cols/psu_rows)
‚îÇ  ‚îú‚îÄ stock-import-csv-lite.php     # –ª—ë–≥–∫–∏–π CSV-–∏–º–ø–æ—Ä—Ç (—Å–∫–ª–∞–¥—ã/–æ—Å—Ç–∞—Ç–∫–∏ ‚Äî lite)
‚îÇ  ‚îî‚îÄ stock-locations-ui.php        # UI-–ø–∞—Ç—á–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø–æ —Å–∫–ª–∞–¥–∞–º
‚îÇ  ‚îî‚îÄ stock-sync-to-woo.php         # —Å–∏–Ω–∫ –±—É—Ñ–µ—Ä–∞ ‚Üí Woo: _stock_at_{TERM_ID}, _stock, —Ç–∞–∫—Å. location
‚îÇ
‚îú‚îÄ plugins/
‚îÇ  ‚îú‚îÄ paint-core/
‚îÇ  ‚îÇ  ‚îú‚îÄ assets/
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ css/
‚îÇ  ‚îÇ  ‚îÇ     ‚îî‚îÄ catalog-qty.css      # —Å—Ç–∏–ª–∏ qty/–∫–Ω–æ–ø–æ–∫ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
‚îÇ  ‚îÇ  ‚îú‚îÄ inc/
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ catalog-qty-add-to-cart.php   # qty + ¬´–≤ –∫–æ—Ä–∑–∏–Ω—É¬ª –≤ –æ–¥–∏–Ω —Ä—è–¥, —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –ª–∏–º–∏—Ç—ã
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ header-allocation-switcher.php# —Å–µ–ª–µ–∫—Ç–æ—Ä—ã ¬´–°–ø–∏—Å–∞–Ω–∏–µ/–°–∫–ª–∞–¥¬ª –≤ —à–∞–ø–∫–µ + AJAX
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ order-allocator.php           # —Ä–∞—Å—á—ë—Ç –ø–ª–∞–Ω–∞ —Å–ø–∏—Å–∞–Ω–∏—è –ø–æ —Å–∫–ª–∞–¥–∞–º (slu_allocation_plan)
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ order-attach-csv.php          # –≤—Å–ø–æ–º. CSV –¥–ª—è –∑–∞–∫–∞–∑–æ–≤
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ role-price-importer.php       # –∏–º–ø–æ—Ä—Ç —Ü–µ–Ω –ø–æ —Ä–æ–ª—è–º (—Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤ –∞–¥–º–∏–Ω–∫–µ)
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ sku-gtin-admin-columns.php    # –∫–æ–ª–æ–Ω–∫–∏ SKU/GTIN –≤ –∞–¥–º–∏–Ω–∫–µ
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ sku-gtin-front-emails.php     # –≤—ã–≤–æ–¥ SKU/GTIN –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ/–≤ –ø–∏—Å—å–º–∞—Ö
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ stock-import-table.php        # —Ç–∞–±–ª–∏—Ü–∞ –∏–º–ø–æ—Ä—Ç–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ stock-locations-display.php   # –≤–∏–¥–∂–µ—Ç—ã/—à–∞–±–ª–æ–Ω—ã –æ—Å—Ç–∞—Ç–∫–æ–≤
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ config.php                    # –±–∞–∑–æ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã/–ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ paint-core.php                # –∑–∞–≥—Ä—É–∑—á–∏–∫ –∏–Ω–∫–ª—É–¥–æ–≤
‚îÇ  ‚îÇ  ‚îî‚îÄ paint-core.php                   # –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø–ª–∞–≥–∏–Ω–∞
‚îÇ  ‚îÇ
‚îÇ  ‚îú‚îÄ paint-shop-ux/
‚îÇ  ‚îÇ  ‚îî‚îÄ paint-shop-ux.php         # –º–µ–ª–∫–∏–µ UX-–ø—Ä–∞–≤–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞
‚îÇ  ‚îÇ
‚îÇ  ‚îú‚îÄ role-price/
‚îÇ     ‚îî‚îÄ role-price.php            # —Ü–µ–Ω—ã –ø–æ —Ä–æ–ª—è–º: –º–µ—Ç–∞-–∫–ª—é—á–∏ _wpc_price_role_*
‚îú‚îÄ themes/
‚îÇ  ‚îî‚îÄ generatepress-child/
‚îÇ     ‚îî‚îÄ style.css                 # —Å–µ—Ç–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ (CSS Grid), –º–µ–ª–∫–∏–µ —Å—Ç–∏–ª–∏
‚îÇ
‚îî‚îÄ uploads/                        # –º–µ–¥–∏–∞ (–≤ Git –Ω–µ —Ö—Ä–∞–Ω–∏–º)
```
</details>



## üöÄ –ö–∞–∫ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø—Ä–æ–µ–∫—Ç
<details>
    <summary><strong> install </strong></summary>
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å WordPress –∏ WooCommerce (—á–µ—Ä–µ–∑ WP-CLI):
   ```bash
   wp core download --locale=ru_RU
   wp core config --dbname=paint --dbuser=root --dbpass=root --dbhost=localhost
   wp core install --url=http://localhost --title="Paint Shop" --admin_user=admin --admin_password=admin --admin_email=admin@example.com
   wp plugin install woocommerce --activate
	2.	–ü–æ–¥—Ç—è–Ω—É—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ñ–∞–π–ª—ã:
   git clone git@github.com:VMalakhatka/paint-shop.git .
   	3.	–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–º—É:
    wp theme activate my-theme
    	4.	–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã:

        wp plugin activate my-custom-plugin

</details>

## üéØ –ö–∞—Ä—Ç–∞ –º–æ–¥—É–ª–µ–π (—á—Ç–æ –∑–∞ —á—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç)
<details>
### üß© MU Plugins
| –§–∞–π–ª / –ú–æ–¥—É–ª—å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ö–ª—é—á–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ / —Ö—É–∫–∏ | –ì–¥–µ –∏—Å–∫–∞—Ç—å –≤ –∞–¥–º–∏–Ω–∫–µ |
|---------------|------------|---------------------------|----------------------|
| **mu-plugins/psu-force-per-page.php** | –í—ã–¥–∞—ë—Ç –Ω–∞ –≤–∏—Ç—Ä–∏–Ω–∞—Ö —Ç–æ–≤–∞—Ä–æ–≤ `per_page = –∫–æ–ª–æ–Ω–∫–∏ √ó —Ä—è–¥—ã`. –ö–æ–ª–æ–Ω–∫–∏ –º–µ—Ä—è—é—Ç—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ, –ø–∏—à—É—Ç—Å—è –≤ cookie. | –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã: `PSUFP_ROWS`, `PSUFP_FALLBACK_COLS`, `PSUFP_COOKIE_COLS`, `PSUFP_COOKIE_ROWS`, `PSUFP_DEBUG`, `PSUFP_ROWS_MOBILE`, `PSUFP_ROWS_MOBILE_BP` | ‚Äî (–∫–æ–¥–æ–≤—ã–π MU-–º–æ–¥—É–ª—å, –±–µ–∑ UI) |
| **mu-plugins/stock-import-csv-lite.php** | –õ—ë–≥–∫–∏–π –∏–º–ø–æ—Ä—Ç CSV (–æ—Å—Ç–∞—Ç–∫–∏ –ø–æ —Å–∫–ª–∞–¥–∞–º). | –ß—Ç–µ–Ω–∏–µ CSV, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã. | Woo ‚Üí –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏–º–ø–æ—Ä—Ç–∞ |
| **mu-plugins/stock-locations-ui.php** | UI-–ø–∞—Ç—á–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø–æ —Å–∫–ª–∞–¥–∞–º (–≤ –∫–∞—Ç–∞–ª–æ–≥–µ –∏ PDP). | –•—É–∫–∏ WooCommerce + —à–∞–±–ª–æ–Ω—ã. | –í –∫–∞—Ä—Ç–æ—á–∫–∞—Ö —Ç–æ–≤–∞—Ä–∞ |

---

### üõ† Paint Core (–∫–∞—Å—Ç–æ–º–Ω—ã–π –ø–ª–∞–≥–∏–Ω)
| –§–∞–π–ª / –ú–æ–¥—É–ª—å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ö–ª—é—á–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ / —Ö—É–∫–∏ | –ì–¥–µ –∏—Å–∫–∞—Ç—å –≤ –∞–¥–º–∏–Ω–∫–µ |
|---------------|------------|---------------------------|----------------------|
| **paint-core/assets/css/catalog-qty.css** | –°—Ç–∏–ª–∏ qty/–∫–Ω–æ–ø–æ–∫ ¬´–≤ –∫–æ—Ä–∑–∏–Ω—É¬ª –≤ –∫–∞—Ç–∞–ª–æ–≥–µ. | CSS –∫–ª–∞—Å—Å—ã: `.loop-qty`, `.loop-buy-row`. | –í–Ω–µ—à–Ω–∏–π –≤–∏–¥ ‚Üí –†–µ–¥–∞–∫—Ç–æ—Ä —Ñ–∞–π–ª–æ–≤ —Ç–µ–º—ã |
| **paint-core/inc/catalog-qty-add-to-cart.php** | qty + –∫–Ω–æ–ø–∫–∞ ¬´–≤ –∫–æ—Ä–∑–∏–Ω—É¬ª –≤ –æ–¥–∏–Ω —Ä—è–¥, –ª–∏–º–∏—Ç—ã –∏ disabled-—Å–æ—Å—Ç–æ—è–Ω–∏—è. | –•—É–∫–∏: `woocommerce_after_shop_loop_item`. | –ö–∞—Ç–∞–ª–æ–≥ Woo |
| **paint-core/inc/header-allocation-switcher.php** | –ë–ª–æ–∫ ¬´–°–ø–∏—Å–∞–Ω–∏–µ: [—Ä–µ–∂–∏–º] [—Å–∫–ª–∞–¥]¬ª. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—ã–±–æ—Ä –≤ —Å–µ—Å—Å–∏—é + cookie. –†–µ–∂–∏–º—ã: `auto`, `manual`, `single`. | Ajax `pc_set_alloc_pref`; cookie `pc_alloc_pref`. | UI –≤ —à–∞–ø–∫–µ |
| **paint-core/inc/order-allocator.php** | –†–∞—Å—á—ë—Ç –ø–ª–∞–Ω–∞ —Å–ø–∏—Å–∞–Ω–∏—è –ø–æ —Å–∫–ª–∞–¥–∞–º (`slu_allocation_plan`). | –§–∏–ª—å—Ç—Ä `slu_allocation_plan`. | ‚Äî |
| **paint-core/inc/order-attach-csv.php** | –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ CSV-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∑–∞–∫–∞–∑–æ–≤. | –ü–∞—Ä—Å–µ—Ä CSV. | Woo ‚Üí –ó–∞–∫–∞–∑—ã |
| **paint-core/inc/role-price-importer.php** | –ò–º–ø–æ—Ä—Ç —Ü–µ–Ω –ø–æ —Ä–æ–ª—è–º (—Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤ –∞–¥–º–∏–Ω–∫–µ). | –ú–µ—Ç–∞-–∫–ª—é—á–∏: `_wpc_price_role_*`. | Woo ‚Üí –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏–º–ø–æ—Ä—Ç–∞ |
| **paint-core/inc/sku-gtin-admin-columns.php** | –î–æ–±–∞–≤–ª—è–µ—Ç SKU/GTIN –≤ —Ç–∞–±–ª–∏—Ü–µ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∞–¥–º–∏–Ω–∫–µ. | –§–∏–ª—å—Ç—Ä `manage_edit-product_columns`. | Woo ‚Üí –¢–æ–≤–∞—Ä—ã |
| **paint-core/inc/sku-gtin-front-emails.php** | –í—ã–≤–æ–¥ SKU/GTIN –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ –∏ –≤ email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö. | –•—É–∫–∏ Woo –ø–∏—Å–µ–º. | Woo ‚Üí Email-—à–∞–±–ª–æ–Ω—ã |
| **paint-core/inc/stock-import-table.php** | –¢–∞–±–ª–∏—Ü–∞ –∏–º–ø–æ—Ä—Ç–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤. | –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü. | Woo ‚Üí –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏–º–ø–æ—Ä—Ç–∞ |
| **paint-core/inc/stock-locations-display.php** | –í–∏–¥–∂–µ—Ç—ã/—à–∞–±–ª–æ–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø–æ —Å–∫–ª–∞–¥–∞–º. | –í—Å—Ç–∞–≤–∫–∞ –±–ª–æ–∫–æ–≤ –æ—Å—Ç–∞—Ç–∫–æ–≤. | PDP / –∫–∞—Ç–∞–ª–æ–≥ |
| **paint-core/inc/config.php** | –ë–∞–∑–æ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏. | ‚Äî | ‚Äî |
| **paint-core/inc/paint-core.php** | –ó–∞–≥—Ä—É–∑—á–∏–∫ –∏–Ω–∫–ª—É–¥–æ–≤. | `require_once`. | ‚Äî |
| **paint-core/paint-core.php** | –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø–ª–∞–≥–∏–Ω–∞ Paint Core. | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–ª–∞–≥–∏–Ω–∞. | Woo ‚Üí –ü–ª–∞–≥–∏–Ω—ã |

---

### üé® UX & –î–æ–ø. –ø–ª–∞–≥–∏–Ω—ã
| –§–∞–π–ª / –ú–æ–¥—É–ª—å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ö–ª—é—á–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ / —Ö—É–∫–∏ | –ì–¥–µ –∏—Å–∫–∞—Ç—å –≤ –∞–¥–º–∏–Ω–∫–µ |
|---------------|------------|---------------------------|----------------------|
| **paint-shop-ux/paint-shop-ux.php** | –ú–µ–ª–∫–∏–µ UX-–ø—Ä–∞–≤–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞. | ‚Äî | ‚Äî |
| **role-price/role-price.php** | –¶–µ–Ω—ã –ø–æ —Ä–æ–ª—è–º: –≤—ã–±–æ—Ä –º–µ—Ç–∞-–∫–ª—é—á–∞ `_wpc_price_role_*`. | Woo —Ñ–∏–ª—å—Ç—Ä `woocommerce_product_get_price`. | Woo ‚Üí –¶–µ–Ω—ã –ø–æ —Ä–æ–ª—è–º |
| **stock-sync-to-woo/stock-sync-to-woo.php** | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –≤ Woo (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏). | –ö—Ä–æ–Ω-—Ö—É–∫–∏ / API. | Woo ‚Üí –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ |

---

### üé≠ –¢–µ–º–∞ (GeneratePress Child)
| –§–∞–π–ª / –ú–æ–¥—É–ª—å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ö–ª—é—á–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ / —Ö—É–∫–∏ | –ì–¥–µ –∏—Å–∫–∞—Ç—å –≤ –∞–¥–º–∏–Ω–∫–µ |
|---------------|------------|---------------------------|----------------------|
| **themes/generatepress-child/style.css** | –°–µ—Ç–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ (CSS Grid), –≤–∏–∑—É–∞–ª –∫–∞—Ä—Ç–æ—á–µ–∫/–∫–Ω–æ–ø–æ–∫/qty; —Å—Ç–∏–ª–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ ¬´–°–ø–∏—Å–∞–Ω–∏–µ/–°–∫–ª–∞–¥¬ª –≤ —à–∞–ø–∫–µ. | `grid-template-columns: repeat(auto-fit, minmax(...))` ‚Äî –º–µ–Ω—è–µ—Ç –∫–æ–ª-–≤–æ –∫–æ–ª–æ–Ω–æ–∫. | –í–Ω–µ—à–Ω–∏–π –≤–∏–¥ ‚Üí –†–µ–¥–∞–∫—Ç–æ—Ä —Ñ–∞–π–ª–æ–≤ —Ç–µ–º—ã |
| **themes/generatepress-child/functions.php** | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π, —Ö–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏. ‚ö†Ô∏è –õ–æ–≥–∏–∫–∞ `per_page` –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ MU. | ‚Äî | ‚Äî |
| **themes/generatepress-child/inc/header-allocation-switcher.php** | –î—É–±–ª–∏—Ä—É—é—â–∏–π –∫–æ–¥ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ —Å–∫–ª–∞–¥–∞ (UI –≤ —Ç–µ–º–µ). | Cookie `pc_alloc_pref`. | –®–∞–ø–∫–∞ —Ç–µ–º—ã |

---

### üóÑ SQL / –ò–º–ø–æ—Ä—Ç
| –§–∞–π–ª / –ú–æ–¥—É–ª—å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ö–ª—é—á–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ / —Ö—É–∫–∏ | –ì–¥–µ –∏—Å–∫–∞—Ç—å –≤ –∞–¥–º–∏–Ω–∫–µ |
|---------------|------------|---------------------------|----------------------|
| **(SQL) ¬´–ò–º–ø–æ—Ä—Ç —Ü–µ–Ω –ø–æ —Ä–æ–ª—è–º¬ª** | –ú–∞—Å—Å–æ–≤–∞—è –∑–∞–ø–∏—Å—å `_wpc_price_role_*` –ø–æ SKU. | –ú–µ—Ç–∞–∫–ª—é—á–∏: `_wpc_price_role_partner`, `_wpc_price_role_opt`, `_wpc_price_role_opt_osn`, `_wpc_price_role_schule`. | Woo ‚Üí –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏–º–ø–æ—Ä—Ç–∞ + –∑–∞–ø—É—Å–∫ SQL |
</details>

## üé≠ –¢–µ–º–∞ (GeneratePress Child)

<details>
<summary><strong>–û–±—â–µ–µ</strong></summary>

**–ò–¥–µ—è.** –¢–µ–º–∞ –æ—Å—Ç–∞—ë—Ç—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ ¬´—Ç–æ–Ω–∫–æ–π¬ª: —Å–µ—Ç–∫–∞/—Å—Ç–∏–ª–∏/–∫–æ—Å–º–µ—Ç–∏–∫–∞. –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ ‚Äî –≤ –ø–ª–∞–≥–∏–Ω–∞—Ö.

**–í–∞–∂–Ω–æ:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ **–∫–æ–ª–æ–Ω–æ–∫** –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç **—Ç–æ–ª—å–∫–æ CSS Grid**.
- –ß–∏—Å–ª–æ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É (`per_page`) –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç MU-–ø–ª–∞–≥–∏–Ω, –∞ –Ω–µ —Ç–µ–º–∞.

</details>

<details>
<summary><strong>–§–∞–π–ª—ã —Ç–µ–º—ã</strong></summary>

| –ü—É—Ç—å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|---|---|
| `wp-content/themes/generatepress-child/style.css` | CSS-—Å–µ—Ç–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ (Grid), —Å—Ç–∏–ª–∏ qty/–∫–Ω–æ–ø–æ–∫, –º–∏–Ω–∏-—Å—Ç–∏–ª–∏ —à–∞–ø–∫–∏ (¬´–°–ø–∏—Å–∞–Ω–∏–µ/–°–∫–ª–∞–¥¬ª). |
| `wp-content/themes/generatepress-child/functions.php` | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π —Ç–µ–º—ã, –ª—ë–≥–∫–∏–µ –ø—Ä–∞–≤–∫–∏ (–Ω–∞–ø—Ä., —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å —Ö–ª–µ–±–Ω—ã—Ö –∫—Ä–æ—à–µ–∫). |
| `wp-content/themes/generatepress-child/header.php` | –®–∞–±–ª–æ–Ω —à–∞–ø–∫–∏ GeneratePress (–æ–±—ã—á–Ω–æ –±–µ–∑ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏; UI —Å–∫–ª–∞–¥–æ–≤ –º–æ–Ω—Ç–∏—Ä—É–µ–º –∏–∑ –ø–ª–∞–≥–∏–Ω–∞). |

</details>

<details>
<summary><strong>style.css ‚Äî –∫–ª—é—á –∫ —Å–µ—Ç–∫–µ –∫–∞—Ç–∞–ª–æ–≥–∞</strong></summary>

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –ø—Ä–∞–≤–∏–ª (–±–µ–∑ –¥—É–±–ª–µ–π):

```css
/* Woo Grid base */
.woocommerce ul.products::before,
.woocommerce ul.products::after { content: none !important; }

.woocommerce ul.products{
  list-style:none; margin:0; padding:0;
  display:grid !important;
  gap:20px;
  grid-auto-flow:row;
  grid-template-columns:repeat(auto-fit, minmax(130px, 1fr));
}

/* Tablet */
@media (max-width:1024px){
  .woocommerce ul.products{
    grid-template-columns:repeat(auto-fit, minmax(160px, 1fr));
  }
}

/* Mobile */
@media (max-width:768px){
  .woocommerce ul.products{
    grid-template-columns:repeat(auto-fit, minmax(100px, 1fr));
  }
}

/* Reset widths that fight the grid */
.woocommerce ul.products li.product{
  float:none !important; width:auto !important; margin:0 !important; clear:none !important;
}
.woocommerce ul.products[class*="columns-"] li.product{
  width:auto !important; clear:none !important; margin-right:0 !important;
}

/* Even if Woo forces columns-1 ‚Äî keep grid */
.woocommerce ul.products.columns-1{ display:grid !important; }

–†—É—á–∫–∏: –º–µ–Ω—è–π ¬´–º–∏–Ω–∏–º—É–º¬ª –≤ minmax(‚Ä¶px, 1fr) ‚Äî —Ç–∞–∫ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–∏—Å–ª–æ –∫–æ–ª–æ–Ω–æ–∫ –Ω–∞ –±—Ä–µ–π–∫–ø–æ–∏–Ω—Ç–µ.
```

</details>

<details>
<summary><strong>functions.php ‚Äî —Ç–æ–ª—å–∫–æ –ª—ë–≥–∫–∏–µ —Ö—É–∫–∏</strong></summary>
<?php
// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π –¥–æ—á–µ—Ä–Ω–µ–π —Ç–µ–º—ã
add_action('wp_enqueue_scripts', function () {
    wp_enqueue_style('generatepress-child-style', get_stylesheet_uri());
});

// –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏: —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
add_filter('woocommerce_breadcrumb_defaults', function ($defaults) {
    $defaults['delimiter'] = ' <span class="breadcrumb-delimiter">‚Üí</span> ';
    return $defaults;
});

</details>
<details>
<summary><strong>–ú–∏–Ω–∏-—Å—Ç–∏–ª–∏ —à–∞–ø–∫–∏ (—Å–µ–ª–µ–∫—Ç–æ—Ä—ã ¬´–°–ø–∏—Å–∞–Ω–∏–µ/–°–∫–ª–∞–¥¬ª)</strong></summary>
/* –†—è–¥–æ–º —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º */
.site-branding{ display:flex; align-items:center; gap:12px; }

/* –ö–æ–Ω—Ç—Ä–æ–ª —Å–ø–∏—Å–∞–Ω–∏—è/—Å–∫–ª–∞–¥–∞ */
.pc-alloc{ display:flex; align-items:center; gap:8px; font:14px/1.2 system-ui; }
.pc-alloc small{ color:#666; }
.pc-alloc select{ max-height:34px; padding:4px 8px; line-height:1.2; min-width:0; }

/* –¢–µ–ª–µ—Ñ–æ–Ω—ã */
@media (max-width:480px){
  .site-branding{ gap:8px; }
  .pc-alloc{ gap:6px; }
  .pc-alloc small{ font-size:12px; }
  .pc-alloc select{ font-size:12px; height:32px; padding:0 22px 0 8px; }
}

/* –û—á–µ–Ω—å —É–∑–∫–∏–µ ‚Äî –≤ —Å—Ç–æ–ª–±–∏–∫ */
@media (max-width:360px){
  .pc-alloc{ flex-direction:column; align-items:stretch; gap:6px; }
  .pc-alloc > *{ width:100%; }
  .pc-alloc small{ display:none; }
}

</details>

## üß© MU-plugins

<details>
<summary><strong>–û–±—â–µ–µ</strong></summary>

MU-–ø–ª–∞–≥–∏–Ω—ã –≥—Ä—É–∑—è—Ç—Å—è –≤—Å–µ–≥–¥–∞ (–±–µ–∑ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤ –∞–¥–º–∏–Ω–∫–µ) –∏–∑ `wp-content/mu-plugins/`.  
–ó–¥–µ—Å—å –ª–µ–∂–∞—Ç ¬´–Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ¬ª –≤–µ—â–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è —Ä–∞–Ω—å—à–µ —Ç–µ–º—ã/–æ–±—ã—á–Ω—ã—Ö –ø–ª–∞–≥–∏–Ω–æ–≤.

</details>

---

<details>
<summary><strong>1) mu-plugins/psu-force-per-page.php ‚Äî –∞–≤—Ç–æ-–ø–µ—Ä–µ—Å—á—ë—Ç per_page</strong></summary>

**–ò–¥–µ—è.** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ = **–∫–æ–ª–æ–Ω–∫–∏ √ó —Ä—è–¥—ã**.  
–ö–æ–ª–æ–Ω–∫–∏ –º–µ—Ä—è—é—Ç—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (–ø–æ CSS Grid), –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ cookie ‚Üí —Å–µ—Ä–≤–µ—Ä —Å—Ç–∞–≤–∏—Ç `posts_per_page`.

### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã (—Ä—É—á–∫–∏)
| –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç | –î–µ—Ñ–æ–ª—Ç |
|---|---|---|
| `PSUFP_COOKIE_COLS` | –∏–º—è cookie —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∫–æ–ª–æ–Ω–æ–∫ | `psu_cols` |
| `PSUFP_COOKIE_ROWS` | –∏–º—è cookie —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ä—è–¥–æ–≤ | `psu_rows` |
| `PSUFP_ROWS_DESKTOP` | —Ä—è–¥—ã –¥–ª—è >480px | `3` |
| `PSUFP_ROWS_MOBILE` | —Ä—è–¥—ã –¥–ª—è 321‚Äì480px | `3` |
| `PSUFP_ROWS_XSMALL` | —Ä—è–¥—ã –¥–ª—è ‚â§320px | `2` |
| `PSUFP_FALLBACK_COLS` | –∫–æ–ª-–≤–æ –∫–æ–ª–æ–Ω–æ–∫ –ø–æ–∫–∞ cookie –Ω–µ—Ç | `5` |
| `PSUFP_DEBUG` | –æ—Ç–ª–∞–¥–∫–∞ (–∑–µ–ª—ë–Ω–∞—è –ø–ª–∞—à–∫–∞ + console.log) | `false` |

### Cookie
- `psu_cols` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–ª–æ–Ω–æ–∫, –∏–∑–º–µ—Ä–µ–Ω–Ω–æ–µ JS.
- `psu_rows` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä—è–¥–æ–≤, –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–µ –ø–æ –±—Ä–µ–π–∫–ø–æ–∏–Ω—Ç–∞–º.

### –ì–¥–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º `per_page`
- `loop_shop_per_page` (WooCommerce)
- `pre_get_posts` (—Ç–æ–ª—å–∫–æ main query, –∞—Ä—Ö–∏–≤—ã —Ç–æ–≤–∞—Ä–æ–≤)
- `woocommerce_product_query` (—Ç–æ–ª—å–∫–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∞—Ä—Ö–∏–≤–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤)

### –í–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- **–Ø–≤–Ω—ã–π –æ–≤–µ—Ä—Ä–∞–π–¥ —á–µ—Ä–µ–∑ URL:** –¥–æ–±–∞–≤–∏—Ç—å `?per_page=N` (1‚Ä¶200).  
  –ú–æ–¥—É–ª—å —É–≤–∞–∂–∏—Ç –∏ –≤–µ—Ä–Ω—ë—Ç —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –≤–º–µ—Å—Ç–æ —Ä–∞—Å—á—ë—Ç–∞.

- **–•—É–∫ –¥–ª—è —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä—è–¥–æ–≤:** –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤—ã–±–æ—Ä —Ä—è–¥–æ–≤ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã:
  ```php
  /**
   * @param int $rows   —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–µ —Ä—è–¥—ã –ø–æ —Ç–µ–∫—É—â–µ–π —à–∏—Ä–∏–Ω–µ
   * @param int $width  —à–∏—Ä–∏–Ω–∞ (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è)
   * @return int
   */
  add_filter('psufp_rows_for_width', function($rows, $width){
      // –ø—Ä–∏–º–µ—Ä: –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ 2 —Ä—è–¥–∞ –Ω–∞ –ª—é–±—ã—Ö –º–æ–±–∏–ª–∫–∞—Ö
      if ($width <= 480) return 2;
      return $rows;
  }, 10, 2);

```  
–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: —Å–µ–π—á–∞—Å –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä—è–¥–æ–≤ –¥–µ–ª–∞–µ—Ç—Å—è –≤ JS; —ç—Ç–æ—Ç —Ñ–∏–ª—å—Ç—Ä ‚Äî –∑–∞–¥–µ–ª –¥–ª—è PHP-—Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π.

	‚Ä¢	–ö—Ç–æ —Ä–µ—à–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–ª–æ–Ω–æ–∫? –¢–æ–ª—å–∫–æ CSS –≤ —Ç–µ–º–µ:
grid-template-columns: repeat(auto-fit, minmax(..., 1fr));
JS –ª–∏—à—å ¬´—Å—á–∏—Ç—ã–≤–∞–µ—Ç¬ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –∫–ª–∞–¥—ë—Ç —á–∏—Å–ª–æ –≤ cookie.

–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
	1.	–í–∫–ª—é—á–∏ define('PSUFP_DEBUG', true); ‚Äî –≤–Ω–∏–∑—É –ø–æ—è–≤–∏—Ç—Å—è –±–ª–æ–∫ –≤–∏–¥–∞:
cols=5, rows=3, per_page=15, w=1280.
	2.	–ü—Ä–æ–≤–µ—Ä—å cookie psu_cols, psu_rows.
	3.	–£–±–µ–¥–∏—Å—å, —á—Ç–æ –≤ DevTools —É .woocommerce ul.products —Ä–µ–∞–ª—å–Ω–æ —Å—Ç–æ–∏—Ç –Ω–∞—à grid-template-columns.
	4.	–ï—Å–ª–∏ ¬´–Ω–µ –¥–æ–±–∏–≤–∞–µ—Ç¬ª –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä—è–¥ ‚Äî –æ–±—ã—á–Ω–æ –ª–∏–±–æ –∫–æ–ª–æ–Ω–æ–∫ –ø–æ—Å—á–∏—Ç–∞–ª–æ—Å—å –º–µ–Ω—å—à–µ, —á–µ–º –æ–∂–∏–¥–∞–ª–æ—Å—å (CSS), –ª–∏–±–æ —Ä—è–¥–æ–≤ –≤—ã–±—Ä–∞–Ω–æ –±–æ–ª—å—à–µ (–∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã).

```
</details>

<details>
<summary><strong>–ò–º–ø–æ—Ä—Ç —Ü–µ–Ω –ø–æ —Ä–æ–ª—è–º (CSV, –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤)</strong></summary>

**–ß—Ç–æ —ç—Ç–æ:** –ø—Ä–æ—Å—Ç–∞—è –∞–¥–º–∏–Ω-—Å—Ç—Ä–∞–Ω–∏—Ü–∞, –∫—É–¥–∞ –º–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–≥—Ä—É–∂–∞–µ—Ç CSV ‚Üí –ø–ª–∞–≥–∏–Ω –æ–±–Ω–æ–≤–ª—è–µ—Ç –º–µ—Ç–∞-—Ü–µ–Ω—ã `_wpc_price_role_*` —É —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ SKU.

**–ì–¥–µ –≤ –∞–¥–º–∏–Ω–∫–µ:** <code>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã ‚Üí –ò–º–ø–æ—Ä—Ç —Ü–µ–Ω (CSV)</code>.

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç CSV (—Ç–æ—á–Ω–æ —ç—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏):**

```csv
sku;partner;opt;opt_osn;schule
CR-001;10.50;11.00;9.90;10.00
CR-002;12;12;11.5;11.5
```
```txt
- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: `;` / `,` / `TAB`.
- –ö–æ–¥–∏—Ä–æ–≤–∫–∞: UTF-8 / CP1251 ‚Äî –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
- –ü—É—Å—Ç—ã–µ –∫–ª–µ—Ç–∫–∏ –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç —Ü–µ–Ω—É –ø–æ —Ä–æ–ª–∏.
- –î–µ—Å—è—Ç–∏—á–Ω—ã–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å `.` –∏–ª–∏ `,` ‚Äî –¥–æ–ø—É—Å—Ç–∏–º.

**–ö–∞–∫–∏–µ —Ä–æ–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è ¬´–∏–∑ –∫–æ—Ä–æ–±–∫–∏¬ª:**
- `partner` ‚Üí `_wpc_price_role_partner`
- `opt` ‚Üí `_wpc_price_role_opt`
- `opt_osn` ‚Üí `_wpc_price_role_opt_osn`
- `schule` ‚Üí `_wpc_price_role_schule`  
(–º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å: –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –≤ `$roleColumns` –≤–Ω—É—Ç—Ä–∏ –ø–ª–∞–≥–∏–Ω–∞)

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:**
1) –ü–æ `sku` –Ω–∞—Ö–æ–¥–∏–º —Ç–æ–≤–∞—Ä (`_sku`).  
2) –î–ª—è –∫–∞–∂–¥–æ–π –Ω–µ–ø—É—Å—Ç–æ–π —Ä–æ–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ–º –º–µ—Ç–∞-–∫–ª—é—á `_wpc_price_role_<role>`.  
3) –ö–æ—Ä–∑–∏–Ω–∞/–≤–∏—Ç—Ä–∏–Ω–∞ —É–≤–∏–¥–∏—Ç –Ω–æ–≤—ã–µ —Ü–µ–Ω—ã (–ø–ª–∞–≥–∏–Ω `role-price` —É–∂–µ –∏—Ö –æ—Ç–¥–∞—ë—Ç).

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å / –æ—Ç–∫–∞—Ç:**
- –û–ø—Ü–∏—è ¬´–°–¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø¬ª ‚Äî —Å–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—É `wp_postmeta_backup_role_price_YYYYMMDDHHMMSS` —Å —Ç–µ–∫—É—â–∏–º–∏ `_wpc_price_role_*`.

**–®–∞–≥–∏ –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞:**
1. –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å CSV (—Å–º. —à–∞–±–ª–æ–Ω –≤—ã—à–µ).
2. –ó–∞–π—Ç–∏ –≤ **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã ‚Üí –ò–º–ø–æ—Ä—Ç —Ü–µ–Ω (CSV)**.
3. –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª ‚Üí (–æ–ø—Ü.) –≤–∫–ª—é—á–∏—Ç—å **–°–¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø** ‚Üí –Ω–∞–∂–∞—Ç—å **–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å**.
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç—á—ë—Ç (—Å–∫–æ–ª—å–∫–æ SKU –Ω–∞–π–¥–µ–Ω–æ/–æ–±–Ω–æ–≤–ª–µ–Ω–æ, —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–ø—É—â–µ–Ω–æ).

**–ó–∞–º–µ—á–∞–Ω–∏—è:**
- –ù–∞ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ API ‚Äî —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è 1‚Äì2 –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ –Ω–µ–¥–µ–ª—é.
- –ö–æ–≥–¥–∞ API –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤, —Å—Ç—Ä–∞–Ω–∏—Ü—É –º–æ–∂–Ω–æ —Å–∫—Ä—ã—Ç—å, –∞ –ª–æ–≥–∏–∫—É ‚Äî –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –Ω–∞ CRON/–≤–µ–±-—Ö—É–∫–∏.
```
</details>

<details>
<summary><strong>2) mu-plugins/stock-import-csv-lite.php ‚Äî –∏–º–ø–æ—Ä—Ç –æ—Å—Ç–∞—Ç–∫–æ–≤ –∏–∑ CSV (Lite)</strong></summary>

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ.** –ó–∞–≥—Ä—É–∂–∞–µ—Ç CSV —Å –æ—Å—Ç–∞—Ç–∫–∞–º–∏ –ø–æ —Å–∫–ª–∞–¥–∞–º –≤ —Ç–∞–±–ª–∏—Ü—É `wp_stock_import`. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–¥–ª–∏–Ω–Ω—ã–π** –∏ **—à–∏—Ä–æ–∫–∏–π** —Ñ–æ—Ä–º–∞—Ç, –∞–≤—Ç–æ-–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–¥–∏—Ä–æ–≤–∫—É –∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å. –ï—Å—Ç—å –∫–Ω–æ–ø–∫–∞ **SMOKE-TEST**.

**–ì–¥–µ –≤ –∞–¥–º–∏–Ω–∫–µ:** ‚öôÔ∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã ‚Üí **–ò–º–ø–æ—Ä—Ç –æ—Å—Ç–∞—Ç–∫–æ–≤ (Lite)**  
**–ü—Ä–∞–≤–∞:** `manage_options` (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã)  
**–¢–∞–±–ª–∏—Ü–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è:** `${$wpdb->prefix}stock_import`

---

### –§–æ—Ä–º–∞—Ç—ã CSV
**1) –î–ª–∏–Ω–Ω—ã–π** ‚Äî –æ–¥–∏–Ω —Å–∫–ª–∞–¥ –≤ —Å—Ç—Ä–æ–∫–µ:
```csv
sku;location_slug;qty
CR-TEST-001;kiev1;10
CR-TEST-001;odesa;3.5
CR-TEST-002;kiev1;0
```
**2) –®–∏—Ä–æ–∫–∏–π ‚Äî —Å–∫–ª–∞–¥—ã –∫–æ–ª–æ–Ω–∫–∞–º–∏:
```csv
sku,kiev1,odesa
A-AZ-001,"68583,91",0
AB-111-10X15,0,0
AB-111-20X20,3,1.5
```
–ü—É—Å—Ç—ã–µ/–Ω—É–ª–µ–≤—ã–µ —è—á–µ–π–∫–∏ –≤ ¬´—à–∏—Ä–æ–∫–æ–º¬ª —Ñ–æ—Ä–º–∞—Ç–µ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è (—Å—Ç—Ä–æ–∫–∏ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è).

‚∏ª
–ö—É–¥–∞ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç:
	‚Ä¢	–¢–∞–±–ª–∏—Ü–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è:

```sql
CREATE TABLE wp_stock_import (
  sku           VARCHAR(191) NOT NULL,
  location_slug VARCHAR(191) NOT NULL,
  qty           DECIMAL(18,3) NOT NULL,
  PRIMARY KEY (sku, location_slug)
);
```  

```
–ê–ª–≥–æ—Ä–∏—Ç–º –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
	‚Ä¢	–ö–æ–¥–∏—Ä–æ–≤–∫–∞: –∞–≤—Ç–æ (UTF-8 / CP1251 / ISO-8859-1 / Windows-1252). –£–±–∏—Ä–∞–µ—Ç—Å—è BOM.
	‚Ä¢	–†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å: –∞–≤—Ç–æ (; / , / TAB). –î–µ—Å—è—Ç–∏—á–Ω—ã–µ: , –∏ . –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è.
	‚Ä¢	–ó–∞–≥–æ–ª–æ–≤–∫–∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è (–∞–ª–∏–∞—Å—ã):
–∫–∏–µ–≤ / –∫–∏—ó–≤ / kiev / –∫ ‚Üí kiev1, –æ–¥–µ—Å—Å–∞ / –æ–¥–µ—Å–∞ / odessa / odesa / –æ ‚Üí odesa. –ù–µ–∑–Ω–∞–∫–æ–º—ã–µ ‚Äî sanitize_title().
	‚Ä¢	–ó–∞–ø–∏—Å—å –∏–¥—ë—Ç –ø–∞–∫–µ—Ç–∞–º–∏ –ø–æ 1000 –∑–Ω–∞—á–µ–Ω–∏–π (bulk insert).
	‚Ä¢	–ö–ª—é—á —Ç–∞–±–ª–∏—Ü—ã: (sku, location_slug). –í—Å—Ç–∞–≤–∫–∞ —Å ON DUPLICATE KEY UPDATE (upsert).
	‚Ä¢	–û–ø—Ü–∏—è TRUNCATE ‚Äî –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ—á–∏—â–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É.
	‚Ä¢	–ö–Ω–æ–ø–∫–∞ SMOKE-TEST —Å–æ–∑–¥–∞—ë—Ç —Å—Ç—Ä–æ–∫—É (CR-TEST-SMOKE, kiev1, 7).

–°—Ö–µ–º–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –≤ –±–∞–∑–µ

üëâ –ü–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–æ –º–µ—Ç–∞-–∫–ª—é—á–∞–º —Ç–æ–≤–∞—Ä–∞ –∏ —Å–≤—è–∑—è–º:
	‚Ä¢	–ù–∞–ª–∏—á–∏–µ –Ω–∞ —Å–∫–ª–∞–¥–∞—Ö:
_stock_at_{term_id} = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, _stock_at_3942 = 12)
	‚Ä¢	–û–±—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫:
_stock = 44
	‚Ä¢	Primary (–æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫–ª–∞–¥):
_yoast_wpseo_primary_location = term_id
	‚Ä¢	–ü—Ä–∏–≤—è–∑–∫–∞ –∫ —Å–∫–ª–∞–¥–∞–º:
wp_term_relationships (taxonomy = location ‚Üí wp_term_taxonomy ‚Üí wp_terms)

–ì–¥–µ —á—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è (–∏—Ç–æ–≥):

–ß—Ç–æ                      –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è
–û–±—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫            wp_postmeta._stock
–û—Å—Ç–∞—Ç–æ–∫ –ø–æ —Å–∫–ª–∞–¥—É        wp_postmeta._stock_at_{term_id}
Primary-—Å–∫–ª–∞–¥            wp_postmeta._yoast_wpseo_primary_location (–∑–Ω–∞—á–µ–Ω–∏–µ = term_id)
–°–ø–∏—Å–æ–∫ –ª–æ–∫–∞—Ü–∏–π —É —Ç–æ–≤–∞—Ä–∞  wp_term_relationships (—Ç–∞–∫—Å–æ–Ω–æ–º–∏—è location ‚Üí wp_term_taxonomy ‚Üí wp_terms)
```
SQL-–ø—Ä–∏–º–µ—Ä (–≤—ã–≥—Ä—É–∑–∏—Ç—å –æ—Å—Ç–∞—Ç–∫–∏ –ø–æ —Å–∫–ª–∞–¥–∞–º –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤)
```sql
SELECT
  p.ID,
  p.post_title,
  sku.meta_value                                AS sku,
  t.term_id,
  t.name                                        AS location_name,
  t.slug                                        AS location_slug,
  CAST(pm_qty.meta_value AS SIGNED)             AS qty,
  CAST(pm_total.meta_value AS SIGNED)           AS total_stock,
  pm_primary.meta_value                         AS primary_location_term_id,
  CASE WHEN pm_primary.meta_value = t.term_id THEN 1 ELSE 0 END AS is_primary
FROM wp_posts p
JOIN wp_postmeta sku
  ON sku.post_id = p.ID
 AND sku.meta_key = '_sku'
 AND sku.meta_value <> ''
/* —Å—Ç—Ä–æ–∫–∏ –≤–∏–¥–∞ _stock_at_{term_id} */
JOIN wp_postmeta pm_qty
  ON pm_qty.post_id = p.ID
 AND pm_qty.meta_key REGEXP '^_stock_at_[0-9]+$'
/* –≤—ã–Ω–∏–º–∞–µ–º term_id –∏–∑ –∫–ª—é—á–∞ */
JOIN wp_terms t
  ON t.term_id = CONVERT(SUBSTRING_INDEX(pm_qty.meta_key, '_stock_at_', -1), UNSIGNED)
JOIN wp_term_taxonomy tt
  ON tt.term_id = t.term_id
 AND tt.taxonomy = 'location'
/* –æ–±—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫ –∏ primary location */
LEFT JOIN wp_postmeta pm_total
  ON pm_total.post_id = p.ID
 AND pm_total.meta_key = '_stock'
LEFT JOIN wp_postmeta pm_primary
  ON pm_primary.post_id = p.ID
 AND pm_primary.meta_key = '_yoast_wpseo_primary_location'
WHERE p.post_type = 'product'
  AND p.post_status IN ('publish','private')
-- AND sku.meta_value = 'CR-CE0900056730'   -- (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ SKU
ORDER BY sku, location_name;
```

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã (DDL)

–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã –Ω–µ—Ç ‚Äî —Å–æ–∑–¥–∞–π:
```
CREATE TABLE wp_stock_import (
  sku           VARCHAR(191) NOT NULL,
  location_slug VARCHAR(191) NOT NULL,
  qty           DECIMAL(18,3) NOT NULL,
  PRIMARY KEY (sku, location_slug)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```
```
–ü–æ–ª—è –æ—Ç—á—ë—Ç–∞ (—á—Ç–æ –≤–µ—Ä–Ω—ë—Ç —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞)
	‚Ä¢	ok (bool), format (long|wide), encoding, delimiter
	‚Ä¢	rows_read (—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –ø—Ä–æ—á–∏—Ç–∞–ª–∏ –∏–∑ CSV)
	‚Ä¢	rows_pushed (—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ/–≤—Å—Ç–∞–≤–ª–µ–Ω–æ)
	‚Ä¢	errors (–ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∏–∑-–∑–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏)
	‚Ä¢	time_sec (–≤—Ä–µ–º—è), last_error (–æ—à–∏–±–∫–∞ –ë–î, –µ—Å–ª–∏ –±—ã–ª–∞)

‚∏ª

–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã / –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
	‚Ä¢	¬´–ù–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω —Ñ–æ—Ä–º–∞—Ç¬ª ‚Äî –ø—Ä–æ–≤–µ—Ä—å –∑–∞–≥–æ–ª–æ–≤–∫–∏. –î–ª—è –¥–ª–∏–Ω–Ω–æ–≥–æ –Ω—É–∂–Ω—ã sku,location_slug,qty.
	‚Ä¢	¬´SKU –Ω–µ –Ω–∞–π–¥–µ–Ω‚Ä¶¬ª ‚Äî —ç—Ç–æ—Ç –∏–º–ø–æ—Ä—Ç –Ω–µ –ª–µ–∑–µ—Ç –≤ –ø—Ä–æ–¥—É–∫—Ç—ã; –æ–Ω —Ç–æ–ª—å–∫–æ –ø–∏—à–µ—Ç –≤ wp_stock_import. –î–∞–ª—å—à–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–±–µ—Ä—ë—Ç –º–æ–¥—É–ª—å —Å–∏–Ω–∫–∞.
	‚Ä¢	¬´–ö–∏—Ä–∏–ª–ª–∏—Ü–∞/–∫—Ä–∞–∫–æ–∑—è–±—Ä—ã¬ª ‚Äî —É–±–µ–¥–∏—Å—å, —á—Ç–æ CSV –≤ UTF-8 –∏–ª–∏ CP1251 (–∞–≤—Ç–æ-–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞).
	‚Ä¢	¬´–ù—É–ª–∏/–ø—É—Å—Ç—ã–µ —è—á–µ–π–∫–∏¬ª ‚Äî –≤ —à–∏—Ä–æ–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –æ–Ω–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è (–Ω–µ —Å–æ–∑–¥–∞—é—Ç —Å—Ç—Ä–æ–∫).
	‚Ä¢	–ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å –æ—à–∏–±–∫—É SQL? ‚Äî –ø–æ–ª–µ last_error –≤ –æ—Ç—á—ë—Ç–µ –∏ wp-content/debug.log (–µ—Å–ª–∏ –≤–∫–ª—é—á—ë–Ω WP_DEBUG_LOG).

‚∏ª

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø–∞–π–ø–ª–∞–π–Ω
	1.	–ó–∞–≥—Ä—É–∑–∏–ª–∏ CSV —Å—é–¥–∞ ‚Üí
	2.	wp_stock_import –∑–∞–ø–æ–ª–Ω–∏–ª–∞—Å—å ‚Üí
	3.	–º–æ–¥—É–ª—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ wp_stock_import –≤ –º–µ—Ç—ã —Ç–æ–≤–∞—Ä–∞ (–∏–ª–∏ –≤ –≤–∞—à—É —Å–∏—Å—Ç–µ–º—É –æ—Å—Ç–∞—Ç–∫–æ–≤).
```
</details>

<details>
<summary><strong>stock-sync-to-woo.php ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –≤ WooCommerce</strong></summary>

```txt
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ.
–ë–µ—Ä—ë—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã wp_stock_import (sku, location_slug, qty) –∏ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç –∏—Ö –≤ WooCommerce:
	‚Ä¢	–ø–∏—à–µ—Ç –æ—Å—Ç–∞—Ç–∫–∏ –≤ –º–µ—Ç–∞-–∫–ª—é—á–∏ _stock_at_{TERM_ID} (–∏ –ø—Ä–∏ –æ–ø—Ü–∏–∏ ‚Äî _stock_at_{slug}),
	‚Ä¢	—Å—É–º–º–∏—Ä—É–µ—Ç –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç _stock,
	‚Ä¢	–æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å in stock / out of stock,
	‚Ä¢	–ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç —Ç–æ–≤–∞—Ä –∫ —Ç–µ—Ä–º–∞–º —Ç–∞–∫—Å–æ–Ω–æ–º–∏–∏ location,
	‚Ä¢	–º–æ–∂–µ—Ç –≤—ã—Å—Ç–∞–≤–∏—Ç—å Primary location.

‚∏ª

–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç
	1.	–ë–µ—Ä—ë–º –ø–∞—Ä—Ç–∏–∏ —Å—Ç—Ä–æ–∫ –∏–∑ wp_stock_import (batch size ‚Äî –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 500).
	2.	–î–ª—è –∫–∞–∂–¥–æ–≥–æ SKU:
	‚Ä¢	–∏—â–µ–º —Ç–æ–≤–∞—Ä –ø–æ SKU (product –∏–ª–∏ variation),
	‚Ä¢	–∏—â–µ–º —Å–∫–ª–∞–¥ –ø–æ location_slug –≤ —Ç–∞–∫—Å–æ–Ω–æ–º–∏–∏ location,
	‚Ä¢	–ø–∏—à–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ _stock_at_{TERM_ID},
	‚Ä¢	–ø—Ä–∏ –≤–∫–ª—é—á—ë–Ω–Ω–æ–π –æ–ø—Ü–∏–∏ ‚Äî –¥—É–±–ª–∏—Ä—É–µ–º –≤ _stock_at_{slug}.
	3.	–û–±–Ω–æ–≤–ª—è–µ–º —Å—É–º–º–∞—Ä–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫ _stock.
	4.	–ü–æ –æ–ø—Ü–∏—è–º:
	‚Ä¢	upd_status ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å _stock_status (instock / outofstock),
	‚Ä¢	set_manage ‚Äî –≤–∫–ª—é—á–∏—Ç—å manage_stock=yes,
	‚Ä¢	attach_terms ‚Äî –ø—Ä–∏–≤—è–∑–∞—Ç—å —Ç–æ–≤–∞—Ä –∫ —Ç–∞–∫—Å–æ–Ω–æ–º–∏–∏ location,
	‚Ä¢	set_primary ‚Äî –µ—Å–ª–∏ –Ω–µ—Ç primary, –ø–æ—Å—Ç–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π –∏–∑ —Å–∫–ª–∞–¥–æ–≤,
	‚Ä¢	delete_rows ‚Äî —É–¥–∞–ª—è—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏,
	‚Ä¢	loop_until_empty ‚Äî –ø–æ–≤—Ç–æ—Ä—è—Ç—å —Ü–∏–∫–ª –¥–æ –ø—É—Å—Ç–æ–π —Ç–∞–±–ª–∏—Ü—ã.

‚∏ª

–û–ø—Ü–∏–∏ (–∞–¥–º–∏–Ω–∫–∞ ‚Üí –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã ‚Üí ¬´–°–∏–Ω—Ö—Ä. –æ—Å—Ç–∞—Ç–∫–æ–≤ ‚Üí Woo¬ª)
	‚Ä¢	Batch size ‚Äî —Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∑–∞ –ø—Ä–æ—Ö–æ–¥.
	‚Ä¢	Dry-Run ‚Äî —Ç–æ–ª—å–∫–æ –ø–æ–∫–∞–∑–∞—Ç—å, –±–µ–∑ –∑–∞–ø–∏—Å–∏.
	‚Ä¢	–§–∏–ª—å—Ç—Ä –ø–æ SKU (–ø—Ä–µ—Ñ–∏–∫—Å) ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä—ã —Å –∑–∞–¥–∞–Ω–Ω—ã–º –ø—Ä–µ—Ñ–∏–∫—Å–æ–º SKU.
	‚Ä¢	–û–±–Ω–æ–≤–ª—è—Ç—å —Å—Ç–∞—Ç—É—Å –Ω–∞–ª–∏—á–∏—è (_stock_status).
	‚Ä¢	–í–∫–ª—é—á–∞—Ç—å manage_stock.
	‚Ä¢	–£–¥–∞–ª—è—Ç—å —Å—Ç—Ä–æ–∫–∏ –∏–∑ wp_stock_import –ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏.
	‚Ä¢	–ö—Ä—É—Ç–∏—Ç—å—Å—è –¥–æ –ø—É—Å—Ç–æ–π —Ç–∞–±–ª–∏—Ü—ã (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫).
	‚Ä¢	–ü—Ä–∏–≤—è–∑—ã–≤–∞—Ç—å location –∫ —Ç–æ–≤–∞—Ä–∞–º.
	‚Ä¢	–°—Ç–∞–≤–∏—Ç—å Primary location.
	‚Ä¢	–î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç—ã –ø–æ slug ‚Äî –ø–∏—Å–∞—Ç—å _stock_at_{slug} –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.

‚∏ª

–ü—Ä–∏–º–µ—Ä —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ —Å–∏–Ω–∫–∞
	‚Ä¢	_stock_at_3942 = 12
	‚Ä¢	_stock_at_3943 = 32
	‚Ä¢	_stock = 44
	‚Ä¢	_yoast_wpseo_primary_location = 3942
	‚Ä¢	–ü—Ä–∏–≤—è–∑–∫–∞ –∫ taxonomy = location (—á–µ—Ä–µ–∑ wp_term_relationships).

‚∏ª

–û—Ç—á—ë—Ç

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:
	‚Ä¢	—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ,
	‚Ä¢	—Å–∫–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–æ,
	‚Ä¢	–∫–∞–∫–∏–µ SKU –Ω–µ –Ω–∞–π–¥–µ–Ω—ã,
	‚Ä¢	–∫–∞–∫–∏–µ location_slug –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω—ã,
	‚Ä¢	–∫–∞–∫–∏–µ –º–µ—Ç–∞-–∫–ª—é—á–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å,
	‚Ä¢	—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π –¥–æ–±–∞–≤–ª–µ–Ω–æ/–æ–±–Ω–æ–≤–ª–µ–Ω–æ –≤ wp_postmeta.

‚∏ª

–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
	‚Ä¢	Dry-Run ‚Üí –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç—á—ë—Ç –±–µ–∑ –∑–∞–ø–∏—Å–∏ –≤ –º–µ—Ç—É.
	‚Ä¢	–ï—Å–ª–∏ SKU –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî –±—É–¥–µ—Ç –≤ not_found_skus.
	‚Ä¢	–ï—Å–ª–∏ —Å–∫–ª–∞–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî –±—É–¥–µ—Ç –≤ not_found_locations.
	‚Ä¢	–°–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã: SELECT COUNT(*) FROM wp_stock_import;.
```
</details>

<details>
<summary><strong>3) mu-plugins/stock-locations-ui.php ‚Äî UI —Å–∫–ª–∞–¥–æ–≤ (–∫–∞—Ç–∞–ª–æ–≥ / PDP / –∫–æ—Ä–∑–∏–Ω–∞)</strong></summary>

```

–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ. –ï–¥–∏–Ω—ã–π –±–ª–æ–∫ –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø–æ —Å–∫–ª–∞–¥–∞–º –∏ —Å—Ç—Ä–æ–∫–∞ ¬´–°–ø–∏—Å–∞–Ω–∏–µ¬ª –≤ –∫–æ—Ä–∑–∏–Ω–µ/—á–µ–∫–∞—É—Ç–µ.
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
	‚Ä¢	–ó–∞–∫–∞–∑ —Å–æ —Å–∫–ª–∞–¥–∞: –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π (–≤—ã–±—Ä–∞–Ω–Ω—ã–π/primary)
	‚Ä¢	–î—Ä—É–≥–∏–µ —Å–∫–ª–∞–¥—ã: —Å–ø–∏—Å–æ–∫ ¬´–ò–º—è ‚Äî qty¬ª (—Ç–æ–ª—å–∫–æ —Å qty > 0)
	‚Ä¢	–í—Å–µ–≥–æ: —Å—É–º–º–∞—Ä–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫
	‚Ä¢	–í –∫–æ—Ä–∑–∏–Ω–µ/—á–µ–∫–∞—É—Ç–µ —Å—Ç—Ä–æ–∫—É ¬´–°–ø–∏—Å–∞–Ω–∏–µ: –ö–∏—ó–≤ ‚Äî 2, –û–¥–µ—Å–∞ ‚Äî 1¬ª –ø–æ –ø–ª–∞–Ω—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.

–†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã: auto / manual / single (–±–µ—Ä—É—Ç—Å—è –∏–∑ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ –≤ —à–∞–ø–∫–µ: cookie/—Å–µ—Å—Å–∏—è).
–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–∫–∞–∑–∞: PDP, –ª—É–ø –∫–∞—Ç–∞–ª–æ–≥–∞, –∫–æ—Ä–∑–∏–Ω–∞/—á–µ–∫–∞—É—Ç.

```
–ì–¥–µ –±–µ—Ä—É—Ç—Å—è –¥–∞–Ω–Ω—ã–µ
```

–ß—Ç–æ                                   –ò—Å—Ç–æ—á–Ω–∏–∫

–°–ø–∏—Å–æ–∫ –ª–æ–∫–∞—Ü–∏–π —Ç–æ–≤–∞—Ä–∞           —Ç–∞–∫—Å–æ–Ω–æ–º–∏—è location (wp_term_relationships ‚Üí wp_terms)
–û—Å—Ç–∞—Ç–æ–∫ –ø–æ –ª–æ–∫–∞—Ü–∏–∏              wp_postmeta._stock_at_{term_id} (–¥–ª—è –≤–∞—Ä–∏–∞—Ü–∏–π ‚Äî —Ñ–æ–ª–±—ç–∫ –∫ —Ä–æ–¥–∏—Ç–µ–ª—é)
–û–±—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫                   wp_postmeta._stock (–µ—Å–ª–∏ –Ω–µ—Ç ‚Äî —Å—É–º–º–∏—Ä—É–µ–º _stock_at_%)
Primary-–ª–æ–∫–∞—Ü–∏—è                 wp_postmeta._yoast_wpseo_primary_location (–∑–Ω–∞—á–µ–Ω–∏–µ = term_id)
–£–∂–µ –≤ –∫–æ—Ä–∑–∏–Ω–µ                   –æ–±—ä—ë–º –∏–∑ WC()->cart –ø–æ –ø—Ä–æ–¥—É–∫—Ç—É/–≤–∞—Ä–∏–∞—Ü–∏–∏

```
–ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
```php

pc_build_stock_view( WC_Product $product ): array
// –°–æ–±–∏—Ä–∞–µ—Ç –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –ª–æ–∫–∞—Ü–∏–∏ –ø–æ–¥ —Ä–µ–∂–∏–º (—É–±–∏—Ä–∞–µ—Ç –Ω—É–ª–µ–≤—ã–µ), –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
// ['mode','preferred','primary','ordered' => [term_id => ['name','qty']], 'sum']

slu_render_stock_panel( WC_Product $product, array $opts = [] ): string
// –†–µ–Ω–¥–µ—Ä –±–ª–æ–∫–∞ (–∫–∞—Ç–∞–ª–æ–≥ + PDP), —É—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–µ–∂–∏–º –∏ –æ–ø—Ü–∏–∏ (—Å–º. —Ç–∞–±–ª–∏—Ü—É –Ω–∏–∂–µ)

slu_get_allocation_plan( WC_Product $product, int $need, string $strategy='primary_first' ): array
// –°—Ç—Ä–æ–∏—Ç –ø–ª–∞–Ω —Å–ø–∏—Å–∞–Ω–∏—è [ term_id => qty ] —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º primary ‚Üí –æ—Å—Ç–∞–ª—å–Ω—ã–µ (qty –ø–æ —É–±—ã–≤–∞–Ω–∏—é)

slu_render_allocation_line( WC_Product $product, int $need ): string
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫—É "–ö–∏—ó–≤ ‚Äî 2, –û–¥–µ—Å–∞ ‚Äî 1" –ø–æ –ø–ª–∞–Ω—É —Å–ø–∏—Å–∞–Ω–∏—è

```
–û–ø—Ü–∏–∏ —Ä–µ–Ω–¥–µ—Ä–∞ –ø–∞–Ω–µ–ª–∏ (slu_render_stock_panel)
```

–û–ø—Ü–∏—è         –¢–∏–ø       –î–µ—Ñ–æ–ª—Ç        –ß—Ç–æ –¥–µ–ª–∞–µ—Ç
wrap_class    string      ''        –î–æ–ø. –∫–ª–∞—Å—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
show_primary  bool      true        –û—Å—Ç–∞–≤–ª–µ–Ω–æ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ (–ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É)
show_others   bool      true        –ü–æ–∫–∞–∑ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–π
show_total    bool      true        –ü–æ–∫–∞–∑ —Å—Ç—Ä–æ–∫–∏ ¬´–í—Å–µ–≥–æ: N¬ª
show_incart   bool      false       (–∑–∞—Ä–µ–∑. –Ω–∞ –±—É–¥—É—â–µ–µ)
show_incart_plan bool   false       (–∑–∞—Ä–µ–∑. –Ω–∞ –±—É–¥—É—â–µ–µ)
hide_when_zero   bool   false       –ï—Å–ª–∏ –Ω–µ—á–µ–≥–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å (–ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω—É–ª–µ–π) ‚Äî —Å–∫—Ä—ã—Ç—å –±–ª–æ–∫

–í–∞–∂–Ω–æ: –ø–µ—Ä–µ–¥ —Ä–µ–Ω–¥–µ—Ä–æ–º –Ω—É–ª–µ–≤—ã–µ —Å–∫–ª–∞–¥—ã –∑–µ—Ä–∫–∞–ª—å–Ω–æ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è (qty <= 0 ‚Üí –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º).
–í —Ä–µ–∂–∏–º–µ single –±–ª–æ–∫ –≤–æ–æ–±—â–µ –Ω–µ —Ä–∏—Å—É–µ—Ç—Å—è, –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–∫–ª–∞–¥ –ø—É—Å—Ç.

‚∏ª

–í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ –≤ —à–∞–±–ª–æ–Ω—ã (–µ—Å—Ç—å –≤ –ø–ª–∞–≥–∏–Ω–µ)
	‚Ä¢	PDP: woocommerce_single_product_summary (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 25)
	‚Ä¢	–ö–∞—Ç–∞–ª–æ–≥: woocommerce_after_shop_loop_item_title (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 11, –∫–ª–∞—Å—Å slu-stock-mini, hide_when_zero=true)
	‚Ä¢	–ö–æ—Ä–∑–∏–Ω–∞/—á–µ–∫–∞—É—Ç (—Å—Ç—Ä–æ–∫–∞ ¬´–°–ø–∏—Å–∞–Ω–∏–µ¬ª):
```
```
add_filter('woocommerce_get_item_data', 'slu_cart_allocation_row', 30, 2);
```
```
–•—É–∫–∏/—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
	‚Ä¢	–ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ —Å–ø–∏—Å–∞–Ω–∏—è:
```
```
add_filter('slu_allocation_plan', function($plan, $product, $need, $strategy){
    // –≤–µ—Ä–Ω–∏ –º–∞—Å—Å–∏–≤ [ term_id => qty ], —á—Ç–æ–±—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É
    return null; // –≤–µ—Ä–Ω—É—Ç—å –º–∞—Å—Å–∏–≤, —á—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏–ª—Å—è –æ–Ω; null ‚Äî –æ—Å—Ç–∞–≤–∏—Ç—å –¥–µ—Ñ–æ–ª—Ç
}, 10, 4);
```
```
	‚Ä¢	–û—Ç–∫–ª—é—á–µ–Ω–∏–µ ¬´—Å—Ç–∞—Ä—ã—Ö¬ª —Å—Ç—Ä–æ–∫ —Å–∫–ª–∞–¥–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ (–µ—Å–ª–∏ –∏—Ö –¥–æ–±–∞–≤–ª—è–µ—Ç –¥—Ä—É–≥–æ–π –º–æ–¥—É–ª—å):
// add_filter('pc_disable_legacy_cart_locations', '__return_true');

–®–æ—Ä—Ç–∫–æ–¥

–ü–æ–∫–∞–∑–∞—Ç—å –ø–ª–∞–Ω —Å–ø–∏—Å–∞–Ω–∏—è –≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ:

[pc_stock_allocation product_id="43189" qty="3"]

–ö–ª–∞—Å—Å—ã –∏ —Å—Ç–∏–ª–∏ (–≤—à–∏—Ç—ã–µ; –º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≤ —Ç–µ–º—É)
	‚Ä¢	slu-stock-box ‚Äî –±–∞–∑–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (PDP)
	‚Ä¢	slu-stock-mini ‚Äî –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –≤–∏–¥ (–∫–∞—Ç–∞–ª–æ–≥)
	‚Ä¢	.is-preferred ‚Äî –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–≥–æ —Å–∫–ª–∞–¥–∞
	‚Ä¢	.slu-nb .slu-stock-total ‚Äî ¬´–í—Å–µ–≥–æ: N¬ª —Ñ–∏–∫—Å–∏—Ä—É–µ–º –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É

‚∏ª

–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
	1.	–ù–∞ PDP/–∫–∞—Ç–∞–ª–æ–≥–µ –Ω–µ—Ç –±–ª–æ–∫–∞ ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –æ—Å—Ç–∞—Ç–∫–æ–≤ > 0 (–Ω—É–ª–∏ —Å–∫—Ä—ã–≤–∞—é—Ç—Å—è), –∏ —á—Ç–æ —Ç–æ–≤–∞—Ä –ø—Ä–∏–≤—è–∑–∞–Ω –∫ —Ç–∞–∫—Å–æ–Ω–æ–º–∏–∏ location.
	2.	–ö–æ—Ä–∑–∏–Ω–∞ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç ¬´–°–ø–∏—Å–∞–Ω–∏–µ¬ª ‚Äî —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç –ø–ª–∞–Ω (slu_get_allocation_plan) –∏ —Ö—É–∫ woocommerce_get_item_data –∞–∫—Ç–∏–≤–µ–Ω.
	3.	–ù—É–∂–µ–Ω –¥—Ä—É–≥–æ–π –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä slu_allocation_plan (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´–≤—Å–µ–≥–¥–∞ —Å–Ω–∞—á–∞–ª–∞ –û–¥–µ—Å—Å–∞¬ª).
	4.	–í —Ä–µ–∂–∏–º–µ single –ø—É—Å—Ç–æ–π —Å–∫–ª–∞–¥ ‚Üí –±–ª–æ–∫ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ –¥–∏–∑–∞–π–Ω—É.
```

</details>

<details>
<summary><strong>5) role-price/role-price.php ‚Äî —Ü–µ–Ω—ã –ø–æ —Ä–æ–ª—è–º (runtime)</strong></summary>

**–ò–¥–µ—è.** –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å **—Å–≤–æ—é —Ü–µ–Ω—É –ø–æ–¥ —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**.  
–ü–ª–∞–≥–∏–Ω –≤ —Ä–∞–Ω—Ç–∞–π–º–µ –ø–æ–¥–º–µ–Ω—è–µ—Ç —Ü–µ–Ω—É, –µ—Å–ª–∏ –¥–ª—è —Ç–µ–∫—É—â–µ–π —Ä–æ–ª–∏ –Ω–∞–π–¥–µ–Ω–∞ –º–µ—Ç–∞.

### –ö–∞–∫ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –º–µ—Ç–∞-–∫–ª—é—á

wpc_price_role
```
–ü—Ä–∏–º–µ—Ä—ã:
- `_wpc_price_role_partner`
- `_wpc_price_role_opt`
- `_wpc_price_role_opt_osn`
- `_wpc_price_role_schule`

> –°—É—Ñ—Ñ–∏–∫—Å –±–µ—Ä—ë—Ç—Å—è –∏–∑ **–ø–µ—Ä–≤–æ–π —Ä–æ–ª–∏** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: `$user->roles[0]`.

### –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è
- –¢–∞–±–ª–∏—Ü–∞: `wp_postmeta`  
- –ö–ª—é—á: `_wpc_price_role_<role>`  
- –ó–Ω–∞—á–µ–Ω–∏–µ: —Ü–µ–Ω–∞ –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞/decimal (–ø–æ—Ç–æ–º –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∫ `wc_get_price_decimals()`)

–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ë–î:
```sql
SELECT post_id, meta_key, meta_value
FROM wp_postmeta
WHERE meta_key LIKE '_wpc_price_role_%'
LIMIT 20;
```
–ö–∞–∫ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ü–µ–Ω–∞ (—Ö—É–∫–∏ –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã)

```
–≠—Ç–∞–ø                        –•—É–∫/–º–µ—Ö–∞–Ω–∏–∑–º                                   –ß—Ç–æ –¥–µ–ª–∞–µ—Ç

–ü–æ–¥–º–µ–Ω–∞ —Ü–µ–Ω—ã —Ç–æ–≤–∞—Ä–∞     woocommerce_product_get_price (prio 5)           –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–∞ —Ü–µ–Ω–∞ –ø–æ–¥ —Ä–æ–ª—å ‚Äî –≤–µ—Ä–Ω—É—Ç—å –µ—ë; 
                                                                            –∏–Ω–∞—á–µ –Ω–µ —Ç—Ä–æ–≥–∞—Ç—å ($price –∫–∞–∫ –±—ã–ª)
                                                                            
–ü–æ–¥–º–µ–Ω–∞ —Ü–µ–Ω—ã –≤–∞—Ä–∏–∞—Ü–∏–∏   woocommerce_product_variation_get_price (prio 5)  –¢–æ –∂–µ, –¥–ª—è –≤–∞—Ä–∏–∞—Ü–∏–π

–†–∞–∑–Ω—ã–µ —Ü–µ–Ω—ã –≤ –∫—ç—à–µ –≤–∞—Ä–∏–∞—Ü–∏–π   woocommerce_get_variation_prices_hash      –î–æ–±–∞–≤–ª—è–µ—Ç —Ä–æ–ª—å –≤ —Ö–µ—à: –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ 
                                                                        —Ç–æ–≤–∞—Ä –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—ã–µ —Ü–µ–Ω—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–æ–ª–µ–π

–ü–µ—Ä–µ—Å—á—ë—Ç –≤ –∫–æ—Ä–∑–∏–Ω–µ        woocommerce_before_calculate_totals            –û–±–Ω–æ–≤–ª—è–µ—Ç —Ü–µ–Ω—É, –µ—Å–ª–∏ —Ç–æ–≤–∞—Ä –¥–æ–±–∞–≤–∏–ª–∏ ¬´–¥–æ¬ª 
                                                                          —Å–º–µ–Ω—ã —Ä–æ–ª–∏/–ø—Ä–∞–≤–∏–ª

–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 5 –≤—ã–±—Ä–∞–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ: –µ—Å–ª–∏ —Å–≤–æ–µ–π —Ü–µ–Ω—ã –Ω–µ—Ç, –º—ã –Ω–µ –º–µ—à–∞–µ–º —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º —Å–∫–∏–¥–∫–∞–º/–ø–ª–∞–≥–∏–Ω–∞–º 
(–∫–æ—Ç–æ—Ä—ã–µ –æ–±—ã—á–Ω–æ –≤–∏—Å—è—Ç –Ω–∞ ~10 –∏ –Ω–∏–∂–µ).

```
CSV / –∏–º–ø–æ—Ä—Ç

–û–±—ã—á–Ω–æ —Ä–æ–ª–∏-—Ü–µ–Ω—ã –∑–∞–≤–æ–∑—è—Ç—Å—è –ø–∞–∫–µ—Ç–æ–º –≤–º–µ—Å—Ç–µ —Å–æ SKU (—Å–º. —Ä–∞–∑–¥–µ–ª ¬´SQL ‚Äî –≤–Ω–µ—Å–µ–Ω–∏–µ —Ü–µ–Ω¬ª).
–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π CSV:
```
sku;partner;opt;opt_osn;schule
CR-001;10.50;11.00;9.90;10.00
```
```
	‚Ä¢	–ü–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞ —Ç—ã –ø–æ–ª—É—á–∏—à—å –º–µ—Ç—ã:
_wpc_price_role_partner, _wpc_price_role_opt, _wpc_price_role_opt_osn, _wpc_price_role_schule –Ω–∞ –ø–æ—Å—Ç–∞—Ö-—Ç–æ–≤–∞—Ä–∞—Ö.
	‚Ä¢	–°–∞–º role-price —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç —ç—Ç–∏ –º–µ—Ç—ã –∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Ü–µ–Ω—É –≤ —Ä–∞–Ω—Ç–∞–π–º–µ. –ò–º–ø–æ—Ä—Ç –¥–µ–ª–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å/SQL.

–ê–ª–≥–æ—Ä–∏—Ç–º –ø–ª–∞–≥–∏–Ω–∞ (–≤ 3 —à–∞–≥–∞—Ö)
	1.	–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –µ–≥–æ –ø–µ—Ä–≤—É—é —Ä–æ–ª—å.
	2.	–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç–∞-–∫–ª—é—á _wpc_price_role_<role> –∏ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –º–µ—Ç—É –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Ç–æ–≤–∞—Ä–∞/–≤–∞—Ä–∏–∞—Ü–∏–∏.
	3.	–ï—Å–ª–∏ –º–µ—Ç–∞ –Ω–µ –ø—É—Å—Ç–∞—è ‚Äî –≤–µ—Ä–Ω—É—Ç—å —ç—Ç—É —Ü–µ–Ω—É; –∏–Ω–∞—á–µ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ, —á—Ç–æ –≤–µ—Ä–Ω—É–ª–æ —è–¥—Ä–æ/–¥—Ä—É–≥–∏–µ –ø–ª–∞–≥–∏–Ω—ã.

–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
	‚Ä¢	¬´–¶–µ–Ω–∞ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è¬ª ‚Äî –ø—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ä–µ–∞–ª—å–Ω–æ –µ—Å—Ç—å —Ä–æ–ª—å (–∞ –Ω–µ guest) –∏ —á—Ç–æ —É —Ç–æ–≤–∞—Ä–∞ –µ—Å—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è –º–µ—Ç–∞.
	‚Ä¢	¬´–°–∫–∏–¥–∫–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è¬ª ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞, –µ—Å–ª–∏ –µ—Å—Ç—å –∫–∞—Å—Ç–æ–º–Ω–∞—è —Ä–æ–ª—å-—Ü–µ–Ω–∞: –æ–Ω–∞ –≥–ª–∞–≤–Ω–µ–µ. –ï—Å–ª–∏ —Ä–æ–ª–∏-—Ü–µ–Ω—ã –Ω–µ—Ç ‚Äî —Å–∫–∏–¥–∫–∏ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –ø–ª–∞–≥–∏–Ω–æ–≤ –æ—Å—Ç–∞—é—Ç—Å—è.
	‚Ä¢	¬´–í–∞—Ä–∏–∞—Ü–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ–¥–Ω—É —Ü–µ–Ω—É –¥–ª—è –≤—Å–µ—Ö¬ª ‚Äî –Ω—É–∂–µ–Ω —Ö—É–∫ woocommerce_get_variation_prices_hash (–æ–Ω –¥–æ–±–∞–≤–ª–µ–Ω).
	‚Ä¢	¬´–ü–æ—Å–ª–µ —Å–º–µ–Ω—ã —Ä–æ–ª–∏ –≤ –∫–æ—Ä–∑–∏–Ω–µ —Å—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞¬ª ‚Äî –ø–µ—Ä–µ—Å—á—ë—Ç –¥–µ–ª–∞–µ—Ç —Ö—É–∫ woocommerce_before_calculate_totals (–æ–Ω –¥–æ–±–∞–≤–ª–µ–Ω).

–ö—É–¥–∞ —Å–º–æ—Ç—Ä–µ—Ç—å –≤ –∫–æ–¥–µ

wp-content/plugins/role-price/role-price.php
–ö–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏:
	‚Ä¢	vp_role_price_override() ‚Äî –ø–æ–¥–º–µ–Ω–∞ —Ü–µ–Ω—ã —Ç–æ–≤–∞—Ä–∞/–≤–∞—Ä–∏–∞—Ü–∏–∏;
	‚Ä¢	—Ñ–∏–ª—å—Ç—Ä —Ö–µ—à–∞ –≤–∞—Ä–∏–∞—Ü–∏–π;
	‚Ä¢	–ø–µ—Ä–µ—Å—á—ë—Ç —Ü–µ–Ω—ã –≤ –∫–æ—Ä–∑–∏–Ω–µ.
```
</details>

<details>
<summary><strong>paint-shop-ux/paint-shop-ux.php ‚Äî UX-–ø—Ä–∞–≤–∫–∏ –∫–∞—Ç–∞–ª–æ–≥–∞</strong></summary>

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ.** –î–µ–ª–∞–µ—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ —Ä–æ–≤–Ω–µ–µ –∏ –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ:
- –∫–æ—Ä–æ—Ç–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –≤ –∫–∞—Ç–∞–ª–æ–≥–µ (–±–µ—Ä—ë—Ç —á–∞—Å—Ç—å –ø–æ—Å–ª–µ `|`, –∏–Ω–∞—á–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–∏–º–≤–æ–ª–æ–≤),
- –µ–¥–∏–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –±–ª–æ–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (desktop/tablet/mobile),
- —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ (—Ä–æ–≤–Ω–æ 2 —Å—Ç—Ä–æ–∫–∏), ¬´–ø–æ–¥–≤–∞–ª¬ª –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–∏–∂–∞—Ç –≤–Ω–∏–∑,
- —á—É—Ç—å –º–µ–Ω—å—à–∏–π H1 –≤ –ª–∏—Å—Ç–∏–Ω–≥–∞—Ö –Ω–∞ –º–æ–±–∏–ª–∫–∞—Ö.

### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã (—Ä—É—á–∫–∏ –ø–ª–∞–≥–∏–Ω–∞)
| –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç | –î–µ—Ñ–æ–ª—Ç |
|---|---|---|
| `PSU_COLS_DESKTOP` | —É–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–ª–æ–Ω–∫–∞–º–∏ PHP-–æ–º (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è; —Å–µ—Ç–∫–∞ —É —Ç–µ–º—ã) | `0` (=–≤—ã–∫–ª) |
| `PSU_IMG_H_DESKTOP` | –≤—ã—Å–æ—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∫–∞—Ç–∞–ª–æ–≥–µ, px | `210` |
| `PSU_IMG_H_TABLET` | –≤—ã—Å–æ—Ç–∞ –Ω–∞ –ø–ª–∞–Ω—à–µ—Ç–µ, px | `190` |
| `PSU_IMG_H_MOBILE` | –≤—ã—Å–æ—Ç–∞ –Ω–∞ –º–æ–±–∏–ª–∫–µ, px | `180` |

> –°–µ—Ç–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ –æ—Å—Ç–∞—ë—Ç—Å—è –∑–∞ **child-theme** (CSS Grid); —ç—Ç–æ—Ç –ø–ª–∞–≥–∏–Ω –Ω–µ —Ç—Ä–æ–≥–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–ª–æ–Ω–æ–∫.

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–ö–æ–º–ø–∞–∫—Ç–Ω—ã–π title:** —Ö—É–∫ `woocommerce_shop_loop_item_title` –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ —Å–≤–æ–π –≤—ã–≤–æ–¥.  
  –õ–æ–≥–∏–∫–∞: –µ—Å–ª–∏ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ –µ—Å—Ç—å `|`, –±–µ—Ä—ë–º –ø—Ä–∞–≤—É—é —á–∞—Å—Ç—å. –ò–Ω–∞—á–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º **–ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–∏–º–≤–æ–ª–æ–≤** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 25, —é–Ω–∏–∫–æ–¥-–±–µ–∑–æ–ø–∞—Å–Ω–æ).
- **–ö–∞—Ä—Ç–∏–Ω–∫–∞:** –∏–Ω–ª–∞–π–Ω-CSS —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –≤—ã—Å–æ—Ç—É, –¥–µ–ª–∞–µ—Ç `object-fit: contain`, –±–µ–ª—ã–π —Ñ–æ–Ω, –ø–∞–¥–¥–∏–Ω–≥–∏.
- **–†–æ–≤–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏:** `.product { display:flex; flex-direction:column }` –∏ –º–∞—Ä–¥–∂–∏–Ω—ã —É –∫–Ω–æ–ø–æ–∫/—Ü–µ–Ω—ã ‚Üí ¬´–ø–æ–¥–≤–∞–ª¬ª –≤—Å–µ–≥–¥–∞ –≤–Ω–∏–∑—É.
- **–ó–∞–≥–æ–ª–æ–≤–∫–∏ —Å–ø–∏—Å–∫–æ–≤:** `H1` –≤ –≤—ã–¥–∞—á–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞ –º–æ–±–∏–ª–∫–∞—Ö —É–º–µ–Ω—å—à–µ–Ω.

### –•—É–∫–∏
- `init` ‚Üí –æ—Ç–∫–ª—é—á–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `woocommerce_template_loop_product_title` –∏ –≤–∫–ª—é—á–∞–µ–º `psu_loop_title`.
- `wp_enqueue_scripts` ‚Üí –∏–Ω–ª–∞–π–Ω-CSS —Å –≤—ã—Å–æ—Ç–∞–º–∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫ –∏ —Ñ–∏–∫—Å–∞–º–∏ –∫–∞—Ä—Ç–æ—á–µ–∫.
- (–æ–ø—Ü.) `loop_shop_columns` –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω ‚Äî –Ω–µ –Ω—É–∂–µ–Ω –ø—Ä–∏ CSS Grid –∏–∑ —Ç–µ–º—ã.

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- **psu-force-per-page (MU):** —Å–æ–≤–º–µ—Å—Ç–∏–º. –≠—Ç–æ—Ç –ø–ª–∞–≥–∏–Ω –Ω–µ –º–µ–Ω—è–µ—Ç `per_page`, —Ç–æ–ª—å–∫–æ –≤—ë—Ä—Å—Ç–∫—É –∫–∞—Ä—Ç–æ—á–µ–∫.
- **–¢–µ–º–∞ (GeneratePress Child):** —Å–µ—Ç–∫–∞ (Grid) –∑–∞–¥–∞—ë—Ç—Å—è –≤ —Ç–µ–º–µ; –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ —Å—Ç–∏–ª–µ–π ‚Äî —É–¥–∞–ª–∏ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Ä–µ—Å–µ—Ç—ã –∏–∑ `style.css` —Ç–µ–º—ã.

### –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–ø—Ä–∏–º–µ—Ä—ã)
```php
// –°–¥–µ–ª–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—ã—à–µ –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ –∏ –Ω–∏–∂–µ –Ω–∞ –º–æ–±–∏–ª–∫–µ
// –≤ –Ω–∞—á–∞–ª–µ –ø–ª–∞–≥–∏–Ω–∞ –æ–±–Ω–æ–≤–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã:
const PSU_IMG_H_DESKTOP = 240;
const PSU_IMG_H_MOBILE  = 160;
```

```text
–ß—Ç–æ –º–µ–Ω—è—Ç—å, –µ—Å–ª–∏ ¬´–Ω–µ –ª–æ–≤–∏—Ç¬ª —á–∞—Å—Ç—å –ø–æ—Å–ª–µ |
	‚Ä¢	–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –±–∞–∑–µ/–∏–º–µ–Ω–∏ —Ç–æ–≤–∞—Ä–∞ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å ‚Äî –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —á–µ—Ä—Ç–∞ | (–∞ –Ω–µ ¬´‚Äî¬ª/¬´-¬ª).
	‚Ä¢	–í —Ñ—É–Ω–∫—Ü–∏–∏ psu_compact_title_after_pipe($title, $reserve) –º–æ–∂–Ω–æ:
	‚Ä¢	–ó–∞–º–µ–Ω–∏—Ç—å strpos($t, '|') –Ω–∞ –ø–æ–∏—Å–∫ –ø–æ –¥—Ä—É–≥–æ–º—É —Å–∏–º–≤–æ–ª—É,
	‚Ä¢	–£–≤–µ–ª–∏—á–∏—Ç—å $reserve (—Å–∫–æ–ª—å–∫–æ —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å, –µ—Å–ª–∏ | –Ω–µ—Ç).
```

</details>

‚öôÔ∏è –ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–æ–¥—É–ª–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏


3) –ö–∞—Ç–∞–ª–æ–∂–Ω–∞—è ‚Äúqty + –≤ –∫–æ—Ä–∑–∏–Ω—É‚Äù (–∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞)

–§–∞–π–ª: wp-content/plugins/paint-core/inc/scatalog-qty-add-to-cart.php (—É —Ç–µ–±—è –º–æ–∂–µ—Ç –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è —á—É—Ç—å –∏–Ω–∞—á–µ, –Ω–æ —ç—Ç–æ UI-–ø–ª–∞–≥–∏–Ω –∫–∞—Ç–∞–ª–æ–≥–∞)
–ó–∞–¥–∞—á–∞:
	‚Ä¢	–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–ª—é—Å/–º–∏–Ω—É—Å –∏ –ø–æ–ª–µ qty –≤ –ª–∏—Å—Ç–∏–Ω–≥–µ;
	‚Ä¢	–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤–≤–æ–¥ –ø–æ –¥–æ—Å—Ç—É–ø–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É;
	‚Ä¢	–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–æ—Ä–∑–∏–Ω—ã.

–ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏/—Ñ–∏–ª—å—Ç—Ä—ã:
	‚Ä¢	pcux_available_qty($product) ‚Äî –æ–±—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫ (—Å—É–º–º–∞ _stock_at_% –ª–∏–±–æ _stock).
	‚Ä¢	pcux_available_for_add($product) ‚Äî –¥–æ—Å—Ç—É–ø–Ω–æ –∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é = –æ–±—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫ ‚àí —É–∂–µ –≤ –∫–æ—Ä–∑–∏–Ω–µ.
	‚Ä¢	woocommerce_add_to_cart_validation –∏ woocommerce_update_cart_validation ‚Äî —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞.
	‚Ä¢	–ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω MU-—Ö–µ–ª–ø–µ—Ä, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è \slu_total_available_qty() –∏ \slu_available_for_add().

–ì–¥–µ –ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ: –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–π pcux_available_qty/pcux_available_for_add –∏–ª–∏ –ø—Ä–æ–∫–∏–Ω—É—Ç—å —Å–≤–æ—é MU-—Ñ—É–Ω–∫—Ü–∏—é slu_*.

‚∏ª

5) –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏ —Ä–µ–∞–ª—å–Ω–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤

–§–∞–π–ª: wp-content/plugins/paint-core/inc/order-allocator.php
–ó–∞–¥–∞—á–∞:
	‚Ä¢	–ù–∞ —ç—Ç–∞–ø–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è/—Å—Ç–∞—Ç—É—Å–∞ —Å—Ç—Ä–æ–∏—Ç –ø–ª–∞–Ω —Å–ø–∏—Å–∞–Ω–∏—è –ø–æ —Å–∫–ª–∞–¥–∞–º –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –∑–∞–∫–∞–∑–∞
‚Üí –º–µ—Ç–∞ _pc_stock_breakdown = [ term_id => qty, ... ], –≤–∏–¥–∏–º–∞—è –º–µ—Ç–∞ ‚Äú–°–∫–ª–∞–¥: –ö–∏—ó–≤ √ó N, –û–¥–µ—Å–∞ √ó M‚Äù, _stock_location_id/_slug.
	‚Ä¢	–ü–æ—Ç–æ–º —Å–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏ –∏–∑ –º–µ—Ç _stock_at_{term_id}, –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç _stock/_stock_status.
	‚Ä¢	–ê–Ω—Ç–∏–¥—É–±–ª—å: —Ñ–ª–∞–∂–æ–∫ _pc_stock_reduced = yes.

–•—É–∫–∏:
	‚Ä¢	–ü–ª–∞–Ω: woocommerce_new_order (—Ä–∞–Ω—å—à–µ), woocommerce_checkout_order_processed (40), woocommerce_order_status_processing/completed (30).
	‚Ä¢	–†–µ–¥—É–∫—Ü–∏—è: —Ç–µ –∂–µ —Å—Ç–∞—Ç—É—Å—ã, –Ω–æ (60) ‚Äî –ø–æ—Å–ª–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–ª–∞–Ω–∞.

–ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞:
	‚Ä¢	—Ñ–∏–ª—å—Ç—Ä slu_allocation_plan ‚Äî –º–æ–∂–µ—à—å –≤–µ—Ä–Ω—É—Ç—å —Å–≤–æ–π [term_id => qty], —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é.

–ì–¥–µ –ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã:
	‚Ä¢	–≤ pc_build_allocation_plan() –ø–æ—Ä—è–¥–æ–∫ ‚Äî —Å–Ω–∞—á–∞–ª–∞ primary, –ø–æ—Ç–æ–º –ø–æ –∏–º–µ–Ω–∏ (–∏–ª–∏ –º–µ–Ω—è–π –Ω–∞ ‚Äú–ø–æ —É–±—ã–≤–∞–Ω–∏—é –æ—Å—Ç–∞—Ç–∫–æ–≤‚Äù).

‚∏ª

6) –ë–∞–∑–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥ —è–¥—Ä–∞

–§–∞–π–ª: wp-content/plugins/paint-core/inc/Config.php (–∏–ª–∏ —Ä—è–¥–æ–º)
–ó–∞–¥–∞—á–∞/–Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
	‚Ä¢	Config::DEBUG ‚Äî –≤–∫–ª—é—á–∞–µ—Ç pc_log() (–ª–æ–≥ –≤ error_log).
	‚Ä¢	Config::DISABLE_LEGACY_CART_LOCATIONS ‚Äî –æ—Ç–∫–ª—é—á–∞–µ—Ç ‚Äú—Å—Ç–∞—Ä—ã–µ‚Äù —Å—Ç—Ä–æ–∫–∏ —Å–∫–ª–∞–¥–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ –∏–∑ —Å—Ç–∞—Ä–æ–≥–æ Paint Core.
	‚Ä¢	Config::ENABLE_STOCK_ALLOCATION ‚Äî –≤–∫–ª—é—á–∞–µ—Ç –Ω–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.
	‚Ä¢	–•–µ–ª–ø–µ—Ä pc_log($msg) (–≤ –Ω–µ–π–º—Å–ø–µ–π—Å–µ PaintCore) ‚Äî –Ω–µ –∑–∞–±—ã–≤–∞–π use function PaintCore\pc_log; –≤ —Ñ–∞–π–ª–∞—Ö, –≥–¥–µ –∑–æ–≤—ë—à—å.

‚∏ª

7) –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–µ–∂–∏–º–∞ —Å–∫–ª–∞–¥–æ–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å)

–§–∞–π–ª: inc/header-allocation-switcher.php (–∏–ª–∏ –ø–æ—Ö–æ–∂–µ–µ –º–µ—Å—Ç–æ –≤ —Ç–µ–º–µ/–ø–ª–∞–≥–∏–Ω–µ)
–ó–∞–¥–∞—á–∞: UI –¥–ª—è auto/manual/single + –≤—ã–±—Ä–∞–Ω–Ω—ã–π term_id.
–í–∞–∂–Ω–æ: –ø–æ—Å–ª–µ —Å–º–µ–Ω—ã —Ä–µ–∂–∏–º–∞ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞—Ç—å PDP/–∫–∞—Ç–∞–ª–æ–≥. –ï—Å–ª–∏ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è ‚Äî –ø—Ä–æ–≤–µ—Ä—å, —á—Ç–æ:
	‚Ä¢	—Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è (cookie/option/session?),
	‚Ä¢	—Ä–∞—Å—á—ë—Ç –≤ pc_build_stock_view() —á–∏—Ç–∞–µ—Ç –∏–º–µ–Ω–Ω–æ —ç—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ,
	‚Ä¢	–µ—Å—Ç—å —Ö—É–∫/JS, –∫–æ—Ç–æ—Ä—ã–π –¥—ë—Ä–≥–∞–µ—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫—É (–∏–ª–∏ –æ–±—ã—á–Ω—ã–π reload).

‚∏ª

8) –¢–µ–º–∞: functions.php (–¥–æ—á–µ—Ä–Ω—è—è)

–§–∞–π–ª: wp-content/themes/generatepress-child/functions.php
–ß—Ç–æ —Ç—É—Ç —Ç–µ–ø–µ—Ä—å —Å—Ç–æ–∏—Ç –æ—Å—Ç–∞–≤–ª—è—Ç—å:
	‚Ä¢	–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π –¥–æ—á–µ—Ä–Ω–µ–π —Ç–µ–º—ã;
	‚Ä¢	–ú–µ–ª–∫–∏–µ –ø—Ä–∞–≤–∫–∏ (—Ö–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏, –∑–∞–≥–æ–ª–æ–≤–∫–∏, –∏ —Ç.–ø.).
–ù–µ –¥–µ—Ä–∂–∏–º —Ç—É—Ç: –ª–æ–≥–∏–∫—É per-page (–≤—ã–Ω–µ—Å–µ–Ω–æ –≤ MU-–ø–ª–∞–≥–∏–Ω), —Å–µ—Ç–∫—É –º–æ–∂–Ω–æ –¥–µ—Ä–∂–∞—Ç—å –≤ style.css.

‚∏ª

–ß–∞—Å—Ç—ã–µ –∑–∞–¥–∞—á–∏ –∏ –≥–¥–µ –ø—Ä–∞–≤–∏—Ç—å
	‚Ä¢	‚Äú–ù–µ –¥–æ–±–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä—è–¥‚Äù: —Å–º. MU-–ø–ª–∞–≥–∏–Ω (—Ä—è–¥—ã/–∫–æ–ª–æ–Ω–∫–∏), CSS minmax, cookie psu_cols/psu_rows.
	‚Ä¢	‚Äú–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω—É–ª–µ–≤–æ–π —Å–∫–ª–∞–¥‚Äù: stock-locations-ui.php ‚Üí pc_build_stock_view() ‚Äî —Ñ–∏–ª—å—Ç—Ä—É–µ–º –Ω—É–ª–∏.
	‚Ä¢	‚Äú–í –∫–æ—Ä–∑–∏–Ω–µ/—á–µ–∫–∞—É—Ç–µ –ø–ª–∞–Ω –ø–µ—Ä–µ—Å—á–∏—Ç–∞–ª—Å—è –Ω–µ —Ç–∞–∫‚Äù: —Å–º. order-allocator.php (–ø–ª–∞–Ω/—Ä–µ–¥—É–∫—Ü–∏—è), —Ñ–∏–ª—å—Ç—Ä slu_allocation_plan.
	‚Ä¢	‚Äú–•–æ—á—É –ø–µ—Ä–≤–∏—á–Ω–æ —Å–ø–∏—Å—ã–≤–∞—Ç—å –∏–∑ –û–¥–µ—Å—Å—ã‚Äù: –ª–∏–±–æ —Å–¥–µ–ª–∞–π –µ—ë primary –≤ –º–µ—Ç–∞—Ö Yoast, –ª–∏–±–æ –ø–µ—Ä–µ–ø–∏—à–∏ –ø–æ—Ä—è–¥–æ–∫ –≤ slu_allocation_plan.
	‚Ä¢	‚Äú–ö–∞—Ç–∞–ª–æ–≥ –¥–∞—ë—Ç –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ, —á–µ–º –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —Å–∫–ª–∞–¥–µ‚Äù: —Å–µ–π—á–∞—Å –ª–∏–º–∏—Ç –∏–¥—ë—Ç –æ—Ç –æ–±—â–µ–≥–æ –æ—Å—Ç–∞—Ç–∫–∞. –ï—Å–ª–∏ –Ω–∞–¥–æ ‚Äú–ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Å–∫–ª–∞–¥—É‚Äù –≤ —Ä–µ–∂–∏–º–µ single, —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π pcux_available_qty()/pcux_available_for_add() (–∏–ª–∏ –¥–∞–π MU-—Ñ—É–Ω–∫—Ü–∏–∏ slu_* —É—á–∏—Ç—ã–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º).

‚∏ª

–ë—ã—Å—Ç—Ä—ã–π —á–µ–∫-–ª–∏—Å—Ç (–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞)
	1.	–í–Ω–∏–∑—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–µ—Å–ª–∏ PSUFP_DEBUG = true) ‚Äî —Å—Ç—Ä–æ–∫–∞ –≤–∏–¥–∞:
cols=5, rows=3, per_page=15 (–ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–Ω—è—Ç—å, —á—Ç–æ –∏–º–µ–Ω–Ω–æ —Å—á–∏—Ç–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç/—Å–µ—Ä–≤–µ—Ä).
	2.	–í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ ‚Äî —Å–æ–æ–±—â–µ–Ω–∏—è [PSUFP] ‚Ä¶ (–∫–æ–ª–æ–Ω–∫–∏/—Ä—è–¥—ã/–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞).
	3.	–í PHP-–ª–æ–≥–∞—Ö ‚Äî [PSU] ‚Ä¶ –æ –ø–µ—Ä–µ—Ö–≤–∞—Ç–µ posts_per_page.
	4.	–ü—Ä–æ–≤–µ—Ä–∏—Ç—å cookie psu_cols/psu_rows.
	5.	–û—Ç–∫—Ä—ã—Ç—å devtools ‚Üí Elements: —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ .woocommerce ul.products –∏–º–µ–µ—Ç –Ω–∞—à grid-template-columns –∏ —á—Ç–æ .columns-* –Ω–µ –ª–æ–º–∞—é—Ç.

‚∏ª

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —É–ø–∞–∫—É—é –≤—Å—ë —ç—Ç–æ –≤ –æ–¥–∏–Ω ‚Äú–∂–∏–≤–æ–π‚Äù README.md (—Å –∫–æ–¥–æ–≤—ã–º–∏ —Å–Ω–∏–ø–ø–µ—Ç–∞–º–∏), –ª–∏–±–æ –¥–æ–±–∞–≤–ª—é –≤ –∞–¥–º–∏–Ω–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É ‚Äú–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—Ç–∞–ª–æ–≥–∞‚Äù, –≥–¥–µ –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å PSUFP_ROWS_* –∏ minmax –±–µ–∑ –ª–µ–∑–∞–Ω–∏—è –≤ —Ñ–∞–π–ª—ã.